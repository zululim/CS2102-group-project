CREATE OR REPLACE FUNCTION min_price()
RETURNS TRIGGER AS
$$ BEGIN
    SELECT pet_type FROM min_price_list MPL 
    WHERE NEW.pet_type = MPL.pet_type;
   IF NEW.price >= MPL.price
   THEN 
    RETURN NEW;
   ELSE
    RETURN MPL.price;
   END IF;
   END; $$
LANGUAGE plpgsql;

CREATE TRIGGER check_price
BEFORE INSERT OR UPDATE ON c_pricelist
FOR EACH ROW EXECUTE PROCEDURE min_price();

CREATE OR REPLACE FUNCTION check_availability()
RETURNS TRIGGER AS 
$$ BEGIN
    SELECT date FROM has_availability HA
    WHERE NEW.name = HA.name AND 
    NEW.date
    IF date != NULL 
    THEN
     RETURN date;
    ELSE
     RETURN NULL;
    END IF; END; $$
LANGUAGE plpgsql;

CREATE TRIGGER is_available
BEFORE INSERT OR UPDATE ON bids_for
FOR EACH ROW EXECUTE PROCEDURE has_availability();

