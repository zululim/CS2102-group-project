CREATE TABLE has_availability (
	caretaker VARCHAR(100) NOT NULL REFERENCES caretakers(name) 
		  ON DELETE cascade,
	s_datetime TIMESTAMP NOT NULL,
	e_datetime TIMESTAMP NOT NULL,
	PRIMARY KEY (caretaker, s_datetime, e_datetime)
);

CREATE TABLE pays (
	pet_type VARCHAR PRIMARY KEY,
	price INTEGER NOT NULL,
	caretaker VARCHAR NOT NULL REFERENCES care_taker (name),
	admin CARCHAR NOT NULL REFERENCES pcs_admin (name)
);

CREATE TABLE owns (
	owner VARCHAR(100) NOT NULL REFERENCES pet_owner(name) 
	      ON DELETE CASCADE,
	pet_name VARCHAR(100),
	pet_type VARCHAR(100),
	special_requirements VARCHAR(500),
	PRIMARY KEY (owner, pet_name, pet_type)
);

CREATE TABLE bids_for (
	caretaker VARCHAR(100) NOT NULL REFERENCES has_availability(caretaker),
	start_date TIMESTAMP NOT NULL REFERENCES has_availability(s_datetime),
	end_date TIMESTAMP NOT NULL REFERENCES has_availability(e_datetime),
	pet_name VARCHAR(100) NOT NULL REFERENCES owns(pet_name),
	pet_type VARCHAR(100) NOT NULL REFERENCES owns(pet_type),
	special_requirements VARCHAR(100) REFERENCES owns(special_requirements)
);

CREATE TABLE users (
	name VARCHAR (100) NOT NULL,
	phone INTEGER NOT NULL,
	address VARCHAR (100),
	transfer ENUM('0','1','2'),
	PRIMARY KEY(name, phone)
);

CREATE TABLE petowner (
	credit_card_info varchar(30) NOT NULL,
	require_date DATE NOT NULL
	name VARCHAR(100) NOT NULL REFERENCES users(name),
	phone INTEGER NOT NULL REFERENCES users(phone),
	PRIMARY KEY(name, phone)
);


CREATE TABLE caretakers (
	availability BOOLEAN
	rating FLOAT(2, 1)
	name VARCHAR(100) NOT NULL REFERENCES users(name),
	phone INTEGER NOT NULL REFERENCES users(phone),
	PRIMARY KEY(name, phone)
);


CREATE TABLE pcsadmin (
	name VARCHAR(100) NOT NULL REFERENCES users(name),
	phone INTEGER NOT NULL REFERENCES users(phone),
	PRIMARY KEY(name, phone)
);

CREATE TABLE transinvolved_in (
	bid_no		INTEGER,
	status		VARCHAR,
	trans_mtd	VARCHAR,
	pay_mtd		VARCHAR,
	rating		VARCHAR DEFAULT NULL,
	FOREIGN KEY (bid_no) REFERENCES bids_for(bid_no) ON DELETE cascade,
	PRIMARY KEY (bid_no)
);

CREATE TABLE c_pricelist (
	c_name		VARCHAR, 
	c_num		INTEGER, 
	pet_type	VARCHAR,
	price		INTEGER, 
	FOREIGN KEY (c_name, c_num) REFERENCES care_taker(c_name, c_num) ON DELETE cascade
);
